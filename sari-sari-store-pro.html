<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>üè™ Sari-Sari Store Pro - Sales & Inventory Tracker</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}:root{--bg:#0f0f23;--card:#1a1a3e;--border:#2d2d5e;--primary:#00d4aa;--danger:#ff6b6b;--warning:#ffd93d;--text:#e8e8ff;--text2:#8888aa}body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:var(--bg);color:var(--text);overflow-x:hidden}.app-header{background:var(--card);border-bottom:2px solid var(--border);padding:1rem;position:sticky;top:0;z-index:100;box-shadow:0 2px 8px rgba(0,0,0,.3)}.header-content{max-width:1200px;margin:0 auto;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:.5rem}.app-title{font-size:1.25rem;font-weight:700;color:var(--primary)}.app-subtitle{font-size:.75rem;color:var(--text2);margin-top:.25rem}.header-date{font-size:.875rem;color:var(--text2)}.nav-tabs{background:var(--card);border-bottom:1px solid var(--border);overflow-x:auto;position:sticky;top:72px;z-index:99}.nav-tabs-inner{display:flex;max-width:1200px;margin:0 auto;gap:.25rem;padding:.5rem}.tab-button{flex:1;min-width:80px;padding:.75rem .5rem;background:0 0;border:none;color:var(--text2);cursor:pointer;font-size:.875rem;transition:all .2s;border-bottom:3px solid transparent;white-space:nowrap}.tab-button:hover{color:var(--text);background:rgba(255,255,255,.05)}.tab-button.active{color:var(--primary);border-bottom-color:var(--primary);font-weight:600}.main-content{flex:1;max-width:1200px;width:100%;margin:0 auto;padding:1rem}.tab-content{display:none;animation:fadeIn .3s}.tab-content.active{display:block}@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.card{background:var(--card);border:1px solid var(--border);border-radius:8px;padding:1.25rem;margin-bottom:1rem}.card-header{font-size:1.125rem;font-weight:600;margin-bottom:1rem}.summary-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1rem;margin-bottom:1.5rem}.summary-card{background:var(--card);border:1px solid var(--border);border-radius:8px;padding:1.25rem;display:flex;flex-direction:column;gap:.5rem}.summary-card.alert{border-color:var(--danger);background:rgba(255,107,107,.1)}.summary-card-label{font-size:.875rem;color:var(--text2)}.summary-card-value{font-size:2rem;font-weight:700}.summary-card-change{font-size:.75rem;display:flex;align-items:center;gap:.25rem}.summary-card-change.positive{color:var(--primary)}.summary-card-change.negative{color:var(--danger)}.btn{padding:.75rem 1.5rem;border:none;border-radius:6px;font-size:1rem;font-weight:600;cursor:pointer;transition:all .2s;display:inline-flex;align-items:center;gap:.5rem;justify-content:center}.btn-primary{background:var(--primary);color:var(--bg)}.btn-primary:hover{background:#00f5c8;transform:translateY(-1px);box-shadow:0 4px 12px rgba(0,212,170,.3)}.btn-secondary{background:var(--card);color:var(--text);border:1px solid var(--border)}.btn-secondary:hover{background:var(--border)}.btn-danger{background:var(--danger);color:#fff}.btn-small{padding:.5rem 1rem;font-size:.875rem}.fab{position:fixed;bottom:2rem;right:2rem;width:60px;height:60px;border-radius:50%;background:var(--primary);color:var(--bg);border:none;font-size:1.5rem;cursor:pointer;box-shadow:0 4px 12px rgba(0,212,170,.4);transition:all .2s;z-index:50}.fab:hover{transform:scale(1.1)}.form-group{margin-bottom:1rem}.form-label{display:block;font-size:.875rem;color:var(--text2);margin-bottom:.5rem;font-weight:500}.form-input,.form-select{width:100%;padding:.75rem;background:var(--bg);border:1px solid var(--border);border-radius:6px;color:var(--text);font-size:1rem}.form-input:focus,.form-select:focus{outline:0;border-color:var(--primary);box-shadow:0 0 0 3px rgba(0,212,170,.1)}.form-row{display:grid;grid-template-columns:1fr 1fr;gap:1rem}.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.8);z-index:200;align-items:center;justify-content:center}.modal.active{display:flex}.modal-content{background:var(--card);border:1px solid var(--border);border-radius:12px;max-width:90%;max-height:90vh;width:600px;overflow-y:auto}.modal-header{padding:1.5rem;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center}.modal-title{font-size:1.25rem;font-weight:600}.modal-close{background:0 0;border:none;color:var(--text2);font-size:1.5rem;cursor:pointer;width:32px;height:32px;display:flex;align-items:center;justify-content:center;border-radius:4px}.modal-body{padding:1.5rem}.modal-footer{padding:1.5rem;border-top:1px solid var(--border);display:flex;gap:1rem;justify-content:flex-end}.list-item{background:var(--bg);border:1px solid var(--border);border-radius:6px;padding:1rem;margin-bottom:.75rem;display:flex;justify-content:space-between;align-items:center;gap:1rem;transition:all .2s}.list-item:hover{border-color:var(--primary);transform:translateX(4px)}.list-item-content{flex:1}.list-item-title{font-weight:600;margin-bottom:.25rem}.list-item-subtitle{font-size:.875rem;color:var(--text2)}.product-item{background:var(--bg);border:1px solid var(--border);border-radius:6px;padding:1rem;display:grid;grid-template-columns:1fr auto;gap:1rem;align-items:center;margin-bottom:.75rem}.product-name{font-weight:600}.product-meta{display:flex;gap:1rem;flex-wrap:wrap;font-size:.875rem;color:var(--text2);margin-top:.5rem}.stock-badge{padding:.25rem .5rem;border-radius:4px;font-size:.75rem;font-weight:600}.stock-badge.ok{background:rgba(0,212,170,.2);color:var(--primary)}.stock-badge.low{background:rgba(255,217,61,.2);color:var(--warning)}.stock-badge.critical{background:rgba(255,107,107,.2);color:var(--danger)}.stock-control{display:flex;align-items:center;gap:.5rem;background:var(--card);border-radius:6px;padding:.25rem}.stock-btn{width:32px;height:32px;border:none;background:var(--border);color:var(--text);border-radius:4px;cursor:pointer;font-size:1.125rem;display:flex;align-items:center;justify-content:center}.stock-btn:hover{background:var(--primary);color:var(--bg)}.stock-value{min-width:40px;text-align:center;font-weight:600}.transaction-item{background:var(--bg);border:1px solid var(--border);border-radius:6px;padding:1rem;margin-bottom:.75rem;cursor:pointer}.transaction-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:.5rem}.transaction-time{font-size:.875rem;color:var(--text2)}.transaction-total{font-size:1.25rem;font-weight:700;color:var(--primary)}.transaction-items{font-size:.875rem;color:var(--text2)}.transaction-details{display:none;margin-top:1rem;padding-top:1rem;border-top:1px solid var(--border)}.transaction-details.expanded{display:block}.toast{position:fixed;bottom:2rem;left:50%;transform:translateX(-50%);background:var(--card);border:1px solid var(--primary);border-radius:8px;padding:1rem 1.5rem;box-shadow:0 4px 12px rgba(0,212,170,.3);z-index:300;display:none}.toast.active{display:block}.toast.error{border-color:var(--danger)}.data-table{width:100%;border-collapse:collapse;margin-top:1rem}.data-table td,.data-table th{padding:.75rem;text-align:left;border-bottom:1px solid var(--border)}.data-table th{background:var(--bg);color:var(--text2);font-weight:600;font-size:.875rem;cursor:pointer}.data-table th:hover{color:var(--primary)}.empty-state{text-align:center;padding:3rem 1rem;color:var(--text2)}.empty-state-icon{font-size:4rem;margin-bottom:1rem}.empty-state-text{font-size:1.125rem;margin-bottom:.5rem}.search-input{width:100%;padding:.75rem;background:var(--bg);border:1px solid var(--border);border-radius:6px;color:var(--text);margin-bottom:1rem}.filter-chips{display:flex;gap:.5rem;flex-wrap:wrap;margin-bottom:1rem}.filter-chip{padding:.5rem 1rem;background:var(--card);border:1px solid var(--border);border-radius:20px;font-size:.875rem;cursor:pointer;transition:all .2s}.filter-chip.active{background:var(--primary);color:var(--bg);border-color:var(--primary)}.cart-item{background:var(--bg);border:1px solid var(--border);border-radius:6px;padding:.75rem;margin-bottom:.5rem;display:flex;justify-content:space-between;align-items:center}.cart-item-name{font-weight:600;margin-bottom:.25rem}.cart-item-details{font-size:.875rem;color:var(--text2)}.cart-item-total{font-weight:700;color:var(--primary)}.remove-item-btn{background:0 0;border:none;color:var(--danger);cursor:pointer;padding:.5rem;font-size:1.125rem}.alert-banner{background:rgba(255,107,107,.1);border:1px solid var(--danger);border-radius:6px;padding:1rem;margin-bottom:1rem;display:flex;align-items:center;gap:.75rem}.icon-btn{background:0 0;border:1px solid var(--border);border-radius:6px;width:36px;height:36px;display:flex;align-items:center;justify-content:center;cursor:pointer;color:var(--text2)}.icon-btn:hover{background:var(--card);color:var(--text);border-color:var(--primary)}@media (max-width:768px){.summary-grid{grid-template-columns:1fr}.summary-card-value{font-size:1.5rem}.form-row{grid-template-columns:1fr}.tab-button{font-size:.75rem;padding:.5rem .25rem}.modal-content{width:95%;max-height:95vh}}.font-bold{font-weight:700}.mt-1{margin-top:1rem}.text-secondary{color:var(--text2)}
</style>
</head>
<body>
<div class="app-container">
<header class="app-header">
<div class="header-content">
<div><div class="app-title">üè™ Sari-Sari Store Pro</div>
<div class="app-subtitle">Sales & Inventory Tracker</div></div>
<div class="header-date" id="headerDate"></div>
</div>
</header>
<nav class="nav-tabs">
<div class="nav-tabs-inner">
<button class="tab-button active" data-tab="dashboard">üìä Dashboard</button>
<button class="tab-button" data-tab="sales">üõí Benta</button>
<button class="tab-button" data-tab="inventory">üì¶ Imbentaryo</button>
<button class="tab-button" data-tab="reports">üìà Reports</button>
<button class="tab-button" data-tab="shopping">üìù Listahan</button>
<button class="tab-button" data-tab="settings">‚öôÔ∏è Settings</button>
</div>
</nav>
<main class="main-content">
<div id="dashboard" class="tab-content active">
<div class="summary-grid" id="dashboardSummary"></div>
<div class="card"><div class="card-header">üèÜ Top 5 Best Sellers (This Week)</div><div id="bestSellersChart"></div></div>
<div class="card"><div class="card-header">üêå Top 5 Slow Movers (This Week)</div><div id="slowMoversChart"></div></div>
<div class="card"><div class="card-header">üìä Daily Sales Trend (Last 7 Days)</div><div id="dailyTrendChart"></div></div>
</div>
<div id="sales" class="tab-content">
<div class="card"><div class="card-header">‚ûï Bagong Benta</div>
<div class="form-group"><label class="form-label">Piliin ang Produkto</label>
<select class="form-select" id="saleProductSelect"><option value="">-- Pumili ng produkto --</option></select></div>
<div class="form-row">
<div class="form-group"><label class="form-label">Dami / Quantity</label><input type="number" class="form-input" id="saleQuantity" min="1" value="1"></div>
<div class="form-group"><label class="form-label">Presyo / Unit Price</label><input type="number" class="form-input" id="saleUnitPrice" readonly></div>
</div>
<div class="form-group"><label class="form-label">Line Total</label><input type="text" class="form-input" id="saleLineTotal" readonly></div>
<button class="btn btn-primary" id="addToCartBtn">üìù Idagdag sa Cart</button>
</div>
<div class="card" id="cartSection" style="display:none">
<div class="card-header">üõí Shopping Cart</div>
<div class="cart-items" id="cartItems"></div>
<div style="border-top:2px solid var(--border);padding-top:1rem;margin-top:1rem">
<div style="display:flex;justify-content:space-between;margin-bottom:.5rem">
<span class="font-bold">Total:</span>
<span class="font-bold" style="color:var(--primary);font-size:1.5rem" id="cartTotal">‚Ç±0.00</span>
</div>
<div class="form-row">
<div class="form-group"><label class="form-label">Bayad / Payment</label><input type="number" class="form-input" id="paymentAmount" min="0" step="0.01"></div>
<div class="form-group"><label class="form-label">Sukli / Change</label><input type="text" class="form-input" id="changeAmount" readonly></div>
</div>
<div style="display:flex;gap:1rem">
<button class="btn btn-primary" style="flex:1" id="recordSaleBtn">‚úÖ I-Record ang Benta</button>
<button class="btn btn-secondary" id="clearCartBtn">üóëÔ∏è Clear</button>
</div>
</div>
</div>
<div class="card"><div class="card-header">üìã Today's Transactions</div><div id="todayTransactions"></div></div>
</div>
<div id="inventory" class="tab-content">
<div id="reorderAlerts"></div>
<div class="card">
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem">
<div class="card-header" style="margin:0">üì¶ Products</div>
<button class="btn btn-primary btn-small" id="addProductBtn">+ Magdagdag</button>
</div>
<input type="text" class="search-input" id="productSearch" placeholder="Maghanap ng produkto...">
<div class="filter-chips" id="categoryFilters"></div>
<div id="productList"></div>
</div>
</div>
<div id="reports" class="tab-content">
<div class="card"><div class="card-header">üìÖ Select Period</div>
<div class="date-range-selector">
<button class="filter-chip active" data-range="today">Today</button>
<button class="filter-chip" data-range="week">This Week</button>
<button class="filter-chip" data-range="month">This Month</button>
<button class="filter-chip" data-range="custom">Custom Range</button>
</div>
<div id="customRangeInputs" style="display:none">
<div class="form-row">
<div class="form-group"><label class="form-label">Start Date</label><input type="date" class="form-input" id="reportStartDate"></div>
<div class="form-group"><label class="form-label">End Date</label><input type="date" class="form-input" id="reportEndDate"></div>
</div>
</div>
</div>
<div class="summary-grid" id="reportSummary"></div>
<div class="card"><div class="card-header">ü•ß Category Breakdown</div><div id="categoryBreakdownChart"></div></div>
<div class="card"><div class="card-header">üìä Daily Revenue Trend</div><div id="reportDailyTrend"></div></div>
<div class="card"><div class="card-header">üìà Product Performance</div>
<div style="overflow-x:auto"><table class="data-table" id="productPerformanceTable">
<thead><tr><th data-sort="name">Product</th><th data-sort="units">Units Sold</th><th data-sort="revenue">Revenue</th><th data-sort="cost">Cost</th><th data-sort="profit">Profit</th><th data-sort="margin">Margin %</th></tr></thead>
<tbody id="productPerformanceBody"></tbody>
</table></div>
</div>
</div>
<div id="shopping" class="tab-content">
<div class="card"><div class="card-header">üìù Reorder List</div>
<p class="text-secondary" style="margin-bottom:1rem">Mga produktong kailangan nang bilhin</p>
<div id="shoppingList"></div>
<div style="border-top:2px solid var(--border);padding-top:1rem;margin-top:1rem">
<div style="display:flex;justify-content:space-between;align-items:center">
<span class="font-bold">Total Estimated Cost:</span>
<span class="font-bold" style="color:var(--primary);font-size:1.5rem" id="shoppingTotal">‚Ç±0.00</span>
</div>
<button class="btn btn-secondary mt-1" style="width:100%" id="printShoppingList">üñ®Ô∏è I-Print / Screenshot</button>
</div>
</div>
</div>
<div id="settings" class="tab-content">
<div class="card"><div class="card-header">‚öôÔ∏è Store Settings</div>
<div class="form-group"><label class="form-label">Pangalan ng Tindahan / Store Name</label><input type="text" class="form-input" id="settingStoreName"></div>
<div class="form-group"><label class="form-label">Pangalan ng May-ari / Owner Name</label><input type="text" class="form-input" id="settingOwnerName"></div>
<div class="form-group"><label class="form-label">Default Reorder Threshold</label><input type="number" class="form-input" id="settingReorderThreshold" min="0"></div>
<button class="btn btn-primary" id="saveSettingsBtn">üíæ Save Settings</button>
</div>
<div class="card"><div class="card-header">üíæ Data Management</div>
<div style="display:flex;flex-direction:column;gap:1rem">
<button class="btn btn-secondary" id="exportDataBtn">üì§ I-Export ang Data</button>
<button class="btn btn-secondary" id="importDataBtn">üì• I-Import ang Data</button>
<input type="file" id="importFileInput" accept=".json" style="display:none">
<button class="btn btn-danger" id="clearAllDataBtn">üóëÔ∏è Burahin Lahat ng Data</button>
</div>
</div>
<div class="card"><div class="card-header">üìñ Paano Gamitin / How to Use</div>
<div style="color:var(--text2);line-height:1.6">
<p style="margin-bottom:.75rem"><strong>1. Mag-record ng benta:</strong> Pumunta sa "Benta" tab, piliin ang produkto, ilagay ang quantity, at i-click ang "I-Record".</p>
<p style="margin-bottom:.75rem"><strong>2. Mag-dagdag ng produkto:</strong> Sa "Imbentaryo" tab, i-click ang "Magdagdag" button at punan ang form.</p>
<p style="margin-bottom:.75rem"><strong>3. Tingnan ang reports:</strong> Pumunta sa "Reports" tab para makita ang sales performance at profits.</p>
<p style="margin-bottom:.75rem"><strong>4. Mag-restock:</strong> Tingnan ang "Listahan" tab para sa automatic reorder suggestions.</p>
<p style="margin-bottom:.75rem"><strong>5. I-backup ang data:</strong> Regular na mag-export ng data para sa safety!</p>
<p style="margin-bottom:.75rem"><strong>6. Offline mode:</strong> Walang internet? Walang problema! Gumana pa rin ang app offline.</p>
</div>
</div>
<div style="text-align:center;padding:2rem;color:var(--text2)">
<p style="margin-bottom:.5rem">Sari-Sari Store Pro v1.0</p>
<p>Salamat sa paggamit! üôè</p>
</div>
</div>
</main>
<button class="fab" id="fabNewSale" title="Bagong Benta">‚ûï</button>
<div class="toast" id="toast"></div>
<div class="modal" id="addProductModal">
<div class="modal-content">
<div class="modal-header"><div class="modal-title">‚ûï Magdagdag ng Produkto</div>
<button class="modal-close" onclick="closeModal('addProductModal')">√ó</button></div>
<div class="modal-body">
<div class="form-group"><label class="form-label">Pangalan ng Produkto *</label><input type="text" class="form-input" id="newProductName"></div>
<div class="form-group"><label class="form-label">Category *</label>
<select class="form-select" id="newProductCategory">
<option value="">-- Pumili --</option>
<option value="Canned Goods">Canned Goods</option>
<option value="Sachets/Packets">Sachets/Packets</option>
<option value="Beverages">Beverages</option>
<option value="Snacks">Snacks</option>
<option value="Rice/Grains">Rice/Grains</option>
<option value="Cigarettes/Tobacco">Cigarettes/Tobacco</option>
<option value="Load/E-Load">Load/E-Load</option>
<option value="Hygiene/Personal Care">Hygiene/Personal Care</option>
<option value="Household">Household</option>
<option value="Frozen">Frozen</option>
<option value="Others">Others</option>
</select></div>
<div class="form-row">
<div class="form-group"><label class="form-label">Presyong Puhunan (Cost) *</label><input type="number" class="form-input" id="newProductCost" min="0" step="0.01"></div>
<div class="form-group"><label class="form-label">Presyong Benta (Selling) *</label><input type="number" class="form-input" id="newProductPrice" min="0" step="0.01"></div>
</div>
<div class="form-row">
<div class="form-group"><label class="form-label">Stock Quantity *</label><input type="number" class="form-input" id="newProductStock" min="0"></div>
<div class="form-group"><label class="form-label">Minimum Stock *</label><input type="number" class="form-input" id="newProductReorder" min="0"></div>
</div>
<div class="form-group"><label class="form-label">Unit Type *</label>
<select class="form-select" id="newProductUnit">
<option value="piraso">piraso (piece)</option>
<option value="pack">pack</option>
<option value="sachet">sachet</option>
<option value="bote">bote (bottle)</option>
<option value="kilo">kilo</option>
<option value="lata">lata (can)</option>
</select></div>
</div>
<div class="modal-footer">
<button class="btn btn-secondary" onclick="closeModal('addProductModal')">Cancel</button>
<button class="btn btn-primary" id="saveProductBtn">üíæ Save Product</button>
</div>
</div>
</div>
<div class="modal" id="editProductModal">
<div class="modal-content">
<div class="modal-header"><div class="modal-title">‚úèÔ∏è I-edit ang Produkto</div>
<button class="modal-close" onclick="closeModal('editProductModal')">√ó</button></div>
<div class="modal-body">
<input type="hidden" id="editProductId">
<div class="form-group"><label class="form-label">Pangalan ng Produkto *</label><input type="text" class="form-input" id="editProductName"></div>
<div class="form-group"><label class="form-label">Category *</label>
<select class="form-select" id="editProductCategory">
<option value="Canned Goods">Canned Goods</option>
<option value="Sachets/Packets">Sachets/Packets</option>
<option value="Beverages">Beverages</option>
<option value="Snacks">Snacks</option>
<option value="Rice/Grains">Rice/Grains</option>
<option value="Cigarettes/Tobacco">Cigarettes/Tobacco</option>
<option value="Load/E-Load">Load/E-Load</option>
<option value="Hygiene/Personal Care">Hygiene/Personal Care</option>
<option value="Household">Household</option>
<option value="Frozen">Frozen</option>
<option value="Others">Others</option>
</select></div>
<div class="form-row">
<div class="form-group"><label class="form-label">Presyong Puhunan (Cost) *</label><input type="number" class="form-input" id="editProductCost" min="0" step="0.01"></div>
<div class="form-group"><label class="form-label">Presyong Benta (Selling) *</label><input type="number" class="form-input" id="editProductPrice" min="0" step="0.01"></div>
</div>
<div class="form-row">
<div class="form-group"><label class="form-label">Stock Quantity *</label><input type="number" class="form-input" id="editProductStock" min="0"></div>
<div class="form-group"><label class="form-label">Minimum Stock *</label><input type="number" class="form-input" id="editProductReorder" min="0"></div>
</div>
<div class="form-group"><label class="form-label">Unit Type *</label>
<select class="form-select" id="editProductUnit">
<option value="piraso">piraso (piece)</option>
<option value="pack">pack</option>
<option value="sachet">sachet</option>
<option value="bote">bote (bottle)</option>
<option value="kilo">kilo</option>
<option value="lata">lata (can)</option>
</select></div>
</div>
<div class="modal-footer">
<button class="btn btn-secondary" onclick="closeModal('editProductModal')">Cancel</button>
<button class="btn btn-primary" id="updateProductBtn">üíæ Update Product</button>
</div>
</div>
</div>
<div class="modal" id="confirmModal">
<div class="modal-content" style="max-width:400px">
<div class="modal-header"><div class="modal-title">‚ö†Ô∏è Confirmation</div>
<button class="modal-close" onclick="closeModal('confirmModal')">√ó</button></div>
<div class="modal-body"><p id="confirmMessage"></p></div>
<div class="modal-footer">
<button class="btn btn-secondary" onclick="closeModal('confirmModal')">Cancel</button>
<button class="btn btn-danger" id="confirmActionBtn">Confirm</button>
</div>
</div>
</div>
</div>
<script>
var Storage={get:function(k){var d=localStorage.getItem(k);return d?JSON.parse(d):null},set:function(k,v){localStorage.setItem(k,JSON.stringify(v))},remove:function(k){localStorage.removeItem(k)}};function generateId(){return Date.now().toString(36)+Math.random().toString(36).substr(2,5)}var DateUtil={formatFilipino:function(date){var mo=['Enero','Pebrero','Marso','Abril','Mayo','Hunyo','Hulyo','Agosto','Setyembre','Oktubre','Nobyembre','Disyembre'];var dy=['Linggo','Lunes','Martes','Miyerkules','Huwebes','Biyernes','Sabado'];var d=new Date(date);return dy[d.getDay()]+', '+mo[d.getMonth()]+' '+d.getDate()+', '+d.getFullYear()},formatShort:function(date){var mo=['Ene','Peb','Mar','Abr','May','Hun','Hul','Ago','Set','Okt','Nob','Dis'];var d=new Date(date);return mo[d.getMonth()]+' '+d.getDate()+', '+d.getFullYear()},formatTime:function(date){return new Date(date).toLocaleTimeString('en-US',{hour:'2-digit',minute:'2-digit'})},isToday:function(date){return new Date(date).toDateString()===new Date().toDateString()},isYesterday:function(date){var y=new Date();y.setDate(y.getDate()-1);return new Date(date).toDateString()===y.toDateString()},getStartOfDay:function(date){var d=new Date(date||new Date());d.setHours(0,0,0,0);return d},getEndOfDay:function(date){var d=new Date(date||new Date());d.setHours(23,59,59,999);return d},getDaysAgo:function(days){var d=new Date();d.setDate(d.getDate()-days);return d}};function initializeSampleData(){var products=Storage.get('spiStore_products');var transactions=Storage.get('spiStore_transactions');var settings=Storage.get('spiStore_settings');if(!settings){settings={storeName:'Tindahan ni Aling Maria',ownerName:'Maria Santos',currency:'‚Ç±',defaultReorderThreshold:10,appVersion:'1.0'};Storage.set('spiStore_settings',settings)}if(!products||products.length===0){products=[{id:generateId(),name:'Lucky Me Pancit Canton',category:'Sachets/Packets',costPrice:9,sellingPrice:12,stock:48,reorderThreshold:20,unit:'sachet',dateAdded:new Date().toISOString(),lastUpdated:new Date().toISOString()},{id:generateId(),name:'Argentina Corned Beef 150g',category:'Canned Goods',costPrice:28,sellingPrice:35,stock:12,reorderThreshold:10,unit:'lata',dateAdded:new Date().toISOString(),lastUpdated:new Date().toISOString()},{id:generateId(),name:'Coca-Cola Mismo 295ml',category:'Beverages',costPrice:12,sellingPrice:15,stock:30,reorderThreshold:15,unit:'bote',dateAdded:new Date().toISOString(),lastUpdated:new Date().toISOString()},{id:generateId(),name:'Kopiko Brown 25g',category:'Sachets/Packets',costPrice:5,sellingPrice:8,stock:60,reorderThreshold:25,unit:'sachet',dateAdded:new Date().toISOString(),lastUpdated:new Date().toISOString()},{id:generateId(),name:'Tide Powder 55g',category:'Household',costPrice:6,sellingPrice:9,stock:40,reorderThreshold:20,unit:'sachet',dateAdded:new Date().toISOString(),lastUpdated:new Date().toISOString()},{id:generateId(),name:'Boy Bawang Cornick 100g',category:'Snacks',costPrice:15,sellingPrice:20,stock:24,reorderThreshold:12,unit:'pack',dateAdded:new Date().toISOString(),lastUpdated:new Date().toISOString()},{id:generateId(),name:'RC Cola 250ml',category:'Beverages',costPrice:10,sellingPrice:13,stock:36,reorderThreshold:15,unit:'bote',dateAdded:new Date().toISOString(),lastUpdated:new Date().toISOString()},{id:generateId(),name:'Bear Brand Adult Plus',category:'Beverages',costPrice:11,sellingPrice:15,stock:30,reorderThreshold:15,unit:'sachet',dateAdded:new Date().toISOString(),lastUpdated:new Date().toISOString()},{id:generateId(),name:'Skyflakes Crackers',category:'Snacks',costPrice:8,sellingPrice:12,stock:20,reorderThreshold:10,unit:'pack',dateAdded:new Date().toISOString(),lastUpdated:new Date().toISOString()},{id:generateId(),name:'NFA Rice 1kg',category:'Rice/Grains',costPrice:42,sellingPrice:52,stock:15,reorderThreshold:8,unit:'kilo',dateAdded:new Date().toISOString(),lastUpdated:new Date().toISOString()},{id:generateId(),name:'Marlboro Red',category:'Cigarettes/Tobacco',costPrice:7,sellingPrice:10,stock:100,reorderThreshold:40,unit:'piraso',dateAdded:new Date().toISOString(),lastUpdated:new Date().toISOString()},{id:generateId(),name:'Smart Load ‚Ç±50',category:'Load/E-Load',costPrice:48,sellingPrice:50,stock:20,reorderThreshold:10,unit:'piraso',dateAdded:new Date().toISOString(),lastUpdated:new Date().toISOString()},{id:generateId(),name:'Globe Load ‚Ç±50',category:'Load/E-Load',costPrice:48,sellingPrice:50,stock:20,reorderThreshold:10,unit:'piraso',dateAdded:new Date().toISOString(),lastUpdated:new Date().toISOString()},{id:generateId(),name:'Safeguard Soap 60g',category:'Hygiene/Personal Care',costPrice:22,sellingPrice:30,stock:18,reorderThreshold:10,unit:'piraso',dateAdded:new Date().toISOString(),lastUpdated:new Date().toISOString()},{id:generateId(),name:'Joy Dishwashing 40ml',category:'Household',costPrice:5,sellingPrice:8,stock:35,reorderThreshold:15,unit:'sachet',dateAdded:new Date().toISOString(),lastUpdated:new Date().toISOString()},{id:generateId(),name:'Purefoods Hotdog 250g',category:'Frozen',costPrice:55,sellingPrice:70,stock:8,reorderThreshold:5,unit:'pack',dateAdded:new Date().toISOString(),lastUpdated:new Date().toISOString()},{id:generateId(),name:'C2 Green Tea 500ml',category:'Beverages',costPrice:18,sellingPrice:25,stock:24,reorderThreshold:12,unit:'bote',dateAdded:new Date().toISOString(),lastUpdated:new Date().toISOString()},{id:generateId(),name:'Silver Swan Soy Sauce 200ml',category:'Household',costPrice:18,sellingPrice:25,stock:15,reorderThreshold:8,unit:'bote',dateAdded:new Date().toISOString(),lastUpdated:new Date().toISOString()},{id:generateId(),name:'Great Taste White 25g',category:'Sachets/Packets',costPrice:5,sellingPrice:8,stock:50,reorderThreshold:25,unit:'sachet',dateAdded:new Date().toISOString(),lastUpdated:new Date().toISOString()},{id:generateId(),name:'Magic Sarap 8g',category:'Sachets/Packets',costPrice:2,sellingPrice:3,stock:80,reorderThreshold:30,unit:'sachet',dateAdded:new Date().toISOString(),lastUpdated:new Date().toISOString()}];Storage.set('spiStore_products',products)}if(!transactions||transactions.length===0){transactions=[];var now=new Date();var yesterday=new Date(now);yesterday.setDate(yesterday.getDate()-1);for(var i=0;i<5;i++){var randomTime=new Date(now);randomTime.setHours(Math.floor(Math.random()*12)+8);randomTime.setMinutes(Math.floor(Math.random()*60));var numItems=Math.floor(Math.random()*3)+1;var items=[];var total=0;for(var j=0;j<numItems;j++){var product=products[Math.floor(Math.random()*products.length)];var quantity=Math.floor(Math.random()*3)+1;var lineTotal=quantity*product.sellingPrice;items.push({productId:product.id,productName:product.name,quantity:quantity,unitPrice:product.sellingPrice,lineTotal:lineTotal});total+=lineTotal}transactions.push({id:generateId(),timestamp:randomTime.toISOString(),items:items,totalAmount:total,paymentReceived:Math.ceil(total/50)*50,change:(Math.ceil(total/50)*50)-total})}for(var i=0;i<3;i++){var randomTime=new Date(yesterday);randomTime.setHours(Math.floor(Math.random()*12)+8);randomTime.setMinutes(Math.floor(Math.random()*60));var numItems=Math.floor(Math.random()*2)+1;var items=[];var total=0;for(var j=0;j<numItems;j++){var product=products[Math.floor(Math.random()*products.length)];var quantity=Math.floor(Math.random()*2)+1;var lineTotal=quantity*product.sellingPrice;items.push({productId:product.id,productName:product.name,quantity:quantity,unitPrice:product.sellingPrice,lineTotal:lineTotal});total+=lineTotal}transactions.push({id:generateId(),timestamp:randomTime.toISOString(),items:items,totalAmount:total,paymentReceived:Math.ceil(total/50)*50,change:(Math.ceil(total/50)*50)-total})}Storage.set('spiStore_transactions',transactions)}}function showToast(message,type){type=type||'success';var toast=document.getElementById('toast');toast.textContent=message;toast.className='toast '+type+' active';setTimeout(function(){toast.classList.remove('active')},3000)}function openModal(modalId){document.getElementById(modalId).classList.add('active')}function closeModal(modalId){document.getElementById(modalId).classList.remove('active')}function initNavigation(){var tabButtons=document.querySelectorAll('.tab-button');var tabContents=document.querySelectorAll('.tab-content');tabButtons.forEach(function(button){button.addEventListener('click',function(){var targetTab=button.dataset.tab;tabButtons.forEach(function(btn){btn.classList.remove('active')});tabContents.forEach(function(content){content.classList.remove('active')});button.classList.add('active');document.getElementById(targetTab).classList.add('active');if(targetTab==='dashboard')renderDashboard();if(targetTab==='sales')renderSalesTab();if(targetTab==='inventory')renderInventoryTab();if(targetTab==='reports')renderReportsTab();if(targetTab==='shopping')renderShoppingList();if(targetTab==='settings')loadSettings()})})}function updateHeaderDate(){var headerDate=document.getElementById('headerDate');headerDate.textContent=DateUtil.formatFilipino(new Date())}function renderDashboard(){var products=Storage.get('spiStore_products')||[];var transactions=Storage.get('spiStore_transactions')||[];var todayTransactions=transactions.filter(function(t){return DateUtil.isToday(t.timestamp)});var yesterdayTransactions=transactions.filter(function(t){return DateUtil.isYesterday(t.timestamp)});var todayRevenue=todayTransactions.reduce(function(sum,t){return sum+t.totalAmount},0);var yesterdayRevenue=yesterdayTransactions.reduce(function(sum,t){return sum+t.totalAmount},0);var todayCost=0;todayTransactions.forEach(function(t){t.items.forEach(function(item){var product=products.find(function(p){return p.id===item.productId});if(product){todayCost+=product.costPrice*item.quantity}})});var todayProfit=todayRevenue-todayCost;var todayItemsSold=todayTransactions.length;var lowStockCount=products.filter(function(p){return p.stock<=p.reorderThreshold}).length;var revenueChange=yesterdayRevenue>0?((todayRevenue-yesterdayRevenue)/yesterdayRevenue*100).toFixed(1):0;var revenueChangeIcon=revenueChange>=0?'üìà':'üìâ';var summaryHtml='<div class="summary-card"><div class="summary-card-label">Benta Ngayon</div><div class="summary-card-value">‚Ç±'+todayRevenue.toFixed(2)+'</div><div class="summary-card-change '+(revenueChange>=0?'positive':'negative')+'">'+revenueChangeIcon+' '+Math.abs(revenueChange)+'% vs yesterday</div></div><div class="summary-card"><div class="summary-card-label">Kita Ngayon</div><div class="summary-card-value">‚Ç±'+todayProfit.toFixed(2)+'</div><div class="summary-card-change positive">üí∞ '+(todayRevenue>0?((todayProfit/todayRevenue)*100).toFixed(1):0)+'% margin</div></div><div class="summary-card"><div class="summary-card-label">Mga Nabentang Item</div><div class="summary-card-value">'+todayItemsSold+'</div><div class="summary-card-change">üõí transactions today</div></div><div class="summary-card '+(lowStockCount>0?'alert':'')+'"><div class="summary-card-label">Low Stock Alert</div><div class="summary-card-value">'+lowStockCount+'</div><div class="summary-card-change '+(lowStockCount>0?'negative':'')+'\">'+(lowStockCount>0?'‚ö†Ô∏è Kailangan mag-restock':'‚úÖ All good')+'</div></div>';document.getElementById('dashboardSummary').innerHTML=summaryHtml;renderBestSellers();renderSlowMovers();renderDailyTrend()}function renderBestSellers(){var products=Storage.get('spiStore_products')||[];var transactions=Storage.get('spiStore_transactions')||[];var weekAgo=DateUtil.getDaysAgo(7);var weekTransactions=transactions.filter(function(t){return new Date(t.timestamp)>=weekAgo});var productSales={};weekTransactions.forEach(function(t){t.items.forEach(function(item){if(!productSales[item.productId]){productSales[item.productId]={name:item.productName,quantity:0}}productSales[item.productId].quantity+=item.quantity})});var sorted=Object.values(productSales).sort(function(a,b){return b.quantity-a.quantity}).slice(0,5);if(sorted.length===0){document.getElementById('bestSellersChart').innerHTML='<div class="empty-state"><div class="empty-state-text">Walang benta pa this week</div></div>';return}var maxQty=Math.max.apply(Math,sorted.map(function(p){return p.quantity}));var html='<div style="display:flex;flex-direction:column;gap:.75rem">';sorted.forEach(function(item,index){var percentage=(item.quantity/maxQty)*100;html+='<div><div style="display:flex;justify-content:space-between;margin-bottom:.25rem"><span style="font-size:.875rem">'+(index+1)+'. '+item.name+'</span><span style="font-weight:700;color:var(--primary)">'+item.quantity+' units</span></div><div style="background:var(--bg);height:8px;border-radius:4px;overflow:hidden"><div style="width:'+percentage+'%;height:100%;background:var(--primary);border-radius:4px"></div></div></div>'});html+='</div>';document.getElementById('bestSellersChart').innerHTML=html}function renderSlowMovers(){var products=Storage.get('spiStore_products')||[];var transactions=Storage.get('spiStore_transactions')||[];var weekAgo=DateUtil.getDaysAgo(7);var weekTransactions=transactions.filter(function(t){return new Date(t.timestamp)>=weekAgo});var productSales={};products.forEach(function(p){productSales[p.id]={name:p.name,quantity:0}});weekTransactions.forEach(function(t){t.items.forEach(function(item){if(productSales[item.productId]){productSales[item.productId].quantity+=item.quantity}})});var sorted=Object.values(productSales).sort(function(a,b){return a.quantity-b.quantity}).slice(0,5);var html='<div style="display:flex;flex-direction:column;gap:.5rem">';sorted.forEach(function(item,index){html+='<div style="display:flex;justify-content:space-between;padding:.5rem;background:var(--bg);border-radius:4px;border-left:3px solid var(--danger)"><span style="font-size:.875rem">'+(index+1)+'. '+item.name+'</span><span style="color:var(--danger);font-weight:600">'+item.quantity+' units</span></div>'});html+='</div>';document.getElementById('slowMoversChart').innerHTML=html}function renderDailyTrend(){var transactions=Storage.get('spiStore_transactions')||[];var last7Days=[];for(var i=6;i>=0;i--){var date=DateUtil.getDaysAgo(i);last7Days.push({date:date,label:date.toLocaleDateString('en-US',{month:'short',day:'numeric'}),revenue:0})}transactions.forEach(function(t){var tDate=DateUtil.getStartOfDay(new Date(t.timestamp));var dayData=last7Days.find(function(d){return d.date.getTime()===tDate.getTime()});if(dayData){dayData.revenue+=t.totalAmount}});var maxRevenue=Math.max.apply(Math,last7Days.map(function(d){return d.revenue}).concat([1]));var html='<svg width="100%" height="200" style="margin-top:1rem">';var barWidth=100/last7Days.length;var padding=10;last7Days.forEach(function(day,index){var barHeight=(day.revenue/maxRevenue)*150;var x=index*barWidth;var y=150-barHeight;html+='<rect x="'+(x+padding/2)+'%" y="'+y+'" width="'+(barWidth-padding)+'%" height="'+barHeight+'" fill="var(--primary)" rx="4"/><text x="'+(x+barWidth/2)+'%" y="170" text-anchor="middle" fill="var(--text2)" font-size="12">'+day.label+'</text><text x="'+(x+barWidth/2)+'%" y="'+(y-5)+'" text-anchor="middle" fill="var(--primary)" font-size="11" font-weight="600">‚Ç±'+day.revenue.toFixed(0)+'</text>'});html+='</svg>';document.getElementById('dailyTrendChart').innerHTML=html}var currentCart=[];function renderSalesTab(){populateProductSelect();renderTodayTransactions();updateCartDisplay()}function populateProductSelect(){var products=Storage.get('spiStore_products')||[];var select=document.getElementById('saleProductSelect');select.innerHTML='<option value="">-- Pumili ng produkto --</option>';products.forEach(function(p){select.innerHTML+='<option value="'+p.id+'">'+p.name+' - ‚Ç±'+p.sellingPrice+' (Stock: '+p.stock+')</option>'})}document.getElementById('saleProductSelect').addEventListener('change',function(){var products=Storage.get('spiStore_products')||[];var product=products.find(function(p){return p.id===this.value}.bind(this));if(product){document.getElementById('saleUnitPrice').value=product.sellingPrice.toFixed(2);document.getElementById('saleQuantity').value=1;updateLineTotal()}else{document.getElementById('saleUnitPrice').value='';document.getElementById('saleLineTotal').value=''}});document.getElementById('saleQuantity').addEventListener('input',updateLineTotal);function updateLineTotal(){var quantity=parseFloat(document.getElementById('saleQuantity').value)||0;var unitPrice=parseFloat(document.getElementById('saleUnitPrice').value)||0;var lineTotal=quantity*unitPrice;document.getElementById('saleLineTotal').value='‚Ç±'+lineTotal.toFixed(2)}document.getElementById('addToCartBtn').addEventListener('click',function(){var productId=document.getElementById('saleProductSelect').value;var quantity=parseFloat(document.getElementById('saleQuantity').value);if(!productId){showToast('Pumili muna ng produkto!','error');return}if(!quantity||quantity<=0){showToast('I-enter ang quantity!','error');return}var products=Storage.get('spiStore_products')||[];var product=products.find(function(p){return p.id===productId});if(!product){showToast('Product not found!','error');return}if(quantity>product.stock){showToast('Kulang ang stock! Available: '+product.stock,'error');return}var existingItem=currentCart.find(function(item){return item.productId===productId});if(existingItem){existingItem.quantity+=quantity;existingItem.lineTotal=existingItem.quantity*existingItem.unitPrice}else{currentCart.push({productId:product.id,productName:product.name,quantity:quantity,unitPrice:product.sellingPrice,lineTotal:quantity*product.sellingPrice})}document.getElementById('saleProductSelect').value='';document.getElementById('saleQuantity').value=1;document.getElementById('saleUnitPrice').value='';document.getElementById('saleLineTotal').value='';updateCartDisplay();showToast('Naidagdag sa cart!','success')});function updateCartDisplay(){var cartSection=document.getElementById('cartSection');var cartItems=document.getElementById('cartItems');var cartTotal=document.getElementById('cartTotal');if(currentCart.length===0){cartSection.style.display='none';return}cartSection.style.display='block';var html='';var total=0;currentCart.forEach(function(item,index){total+=item.lineTotal;html+='<div class="cart-item"><div class="cart-item-info"><div class="cart-item-name">'+item.productName+'</div><div class="cart-item-details">'+item.quantity+' √ó ‚Ç±'+item.unitPrice.toFixed(2)+'</div></div><div style="display:flex;align-items:center;gap:1rem"><div class="cart-item-total">‚Ç±'+item.lineTotal.toFixed(2)+'</div><button class="remove-item-btn" onclick="removeFromCart('+index+')">√ó</button></div></div>'});cartItems.innerHTML=html;cartTotal.textContent='‚Ç±'+total.toFixed(2);document.getElementById('paymentAmount').value='';document.getElementById('changeAmount').value=''}function removeFromCart(index){currentCart.splice(index,1);updateCartDisplay();showToast('Natanggal sa cart','success')}document.getElementById('paymentAmount').addEventListener('input',function(){var total=currentCart.reduce(function(sum,item){return sum+item.lineTotal},0);var payment=parseFloat(this.value)||0;var change=payment-total;document.getElementById('changeAmount').value=change>=0?'‚Ç±'+change.toFixed(2):'Kulang ang bayad'});document.getElementById('clearCartBtn').addEventListener('click',function(){if(currentCart.length===0)return;if(confirm('I-clear ang cart?')){currentCart=[];updateCartDisplay();showToast('Cart cleared','success')}});document.getElementById('recordSaleBtn').addEventListener('click',function(){if(currentCart.length===0){showToast('Walang laman ang cart!','error');return}var total=currentCart.reduce(function(sum,item){return sum+item.lineTotal},0);var payment=parseFloat(document.getElementById('paymentAmount').value)||0;if(payment<total){showToast('Kulang ang bayad!','error');return}var products=Storage.get('spiStore_products')||[];for(var i=0;i<currentCart.length;i++){var item=currentCart[i];var product=products.find(function(p){return p.id===item.productId});if(!product||product.stock<item.quantity){showToast('Kulang ang stock para sa '+item.productName+'!','error');return}}currentCart.forEach(function(item){var product=products.find(function(p){return p.id===item.productId});if(product){product.stock-=item.quantity;product.lastUpdated=new Date().toISOString()}});Storage.set('spiStore_products',products);var transactions=Storage.get('spiStore_transactions')||[];var change=payment-total;transactions.push({id:generateId(),timestamp:new Date().toISOString(),items:currentCart.slice(),totalAmount:total,paymentReceived:payment,change:change});Storage.set('spiStore_transactions',transactions);showToast('Benta na-record! üéâ','success');currentCart=[];updateCartDisplay();renderTodayTransactions();populateProductSelect()});function renderTodayTransactions(){var transactions=Storage.get('spiStore_transactions')||[];var todayTransactions=transactions.filter(function(t){return DateUtil.isToday(t.timestamp)}).sort(function(a,b){return new Date(b.timestamp)-new Date(a.timestamp)});var container=document.getElementById('todayTransactions');if(todayTransactions.length===0){container.innerHTML='<div class="empty-state"><div class="empty-state-icon">üõí</div><div class="empty-state-text">Wala pang benta ngayon</div><div class="empty-state-subtext">Mag-record ng una mong benta!</div></div>';return}var html='';todayTransactions.forEach(function(t){var itemsList=t.items.map(function(i){return i.quantity+'√ó '+i.productName}).join(', ');var detailsHtml=t.items.map(function(i){return'<div style="display:flex;justify-content:space-between;margin-bottom:.5rem"><span>'+i.quantity+' √ó '+i.productName+' @ ‚Ç±'+i.unitPrice.toFixed(2)+'</span><span>‚Ç±'+i.lineTotal.toFixed(2)+'</span></div>'}).join('');html+='<div class="transaction-item" onclick="toggleTransactionDetails(\''+t.id+'\')"><div class="transaction-header"><div class="transaction-time">'+DateUtil.formatTime(t.timestamp)+'</div><div class="transaction-total">‚Ç±'+t.totalAmount.toFixed(2)+'</div></div><div class="transaction-items">'+itemsList+'</div><div class="transaction-details" id="trans-'+t.id+'">'+detailsHtml+'<div style="border-top:1px solid var(--border);padding-top:.5rem;margin-top:.5rem"><div style="display:flex;justify-content:space-between;margin-bottom:.25rem"><span>Total:</span><span class="font-bold">‚Ç±'+t.totalAmount.toFixed(2)+'</span></div><div style="display:flex;justify-content:space-between;margin-bottom:.25rem"><span>Bayad:</span><span>‚Ç±'+t.paymentReceived.toFixed(2)+'</span></div><div style="display:flex;justify-content:space-between"><span>Sukli:</span><span>‚Ç±'+t.change.toFixed(2)+'</span></div></div><button class="btn btn-danger btn-small mt-1" onclick="event.stopPropagation();deleteTransaction(\''+t.id+'\')">üóëÔ∏è Delete</button></div></div>'});container.innerHTML=html}function toggleTransactionDetails(transId){var details=document.getElementById('trans-'+transId);details.classList.toggle('expanded')}function deleteTransaction(transId){if(!confirm('I-delete ba ang transaction na ito?'))return;var transactions=Storage.get('spiStore_transactions')||[];transactions=transactions.filter(function(t){return t.id!==transId});Storage.set('spiStore_transactions',transactions);showToast('Transaction deleted','success');renderTodayTransactions()}var currentFilter='All';var searchQuery='';function renderInventoryTab(){renderReorderAlerts();renderCategoryFilters();renderProductList()}function renderReorderAlerts(){var products=Storage.get('spiStore_products')||[];var lowStockProducts=products.filter(function(p){return p.stock<=p.reorderThreshold}).sort(function(a,b){var aRatio=a.stock/a.reorderThreshold;var bRatio=b.stock/b.reorderThreshold;return aRatio-bRatio});var container=document.getElementById('reorderAlerts');if(lowStockProducts.length===0){container.innerHTML='';return}container.innerHTML='<div class="alert-banner"><div class="alert-banner-icon">‚ö†Ô∏è</div><div class="alert-banner-content"><div class="alert-banner-title">Low Stock Alert</div><div class="alert-banner-text">'+lowStockProducts.length+' products need restocking</div></div></div>'}function renderCategoryFilters(){var categories=['All','Canned Goods','Sachets/Packets','Beverages','Snacks','Rice/Grains','Cigarettes/Tobacco','Load/E-Load','Hygiene/Personal Care','Household','Frozen','Others'];var html='';categories.forEach(function(cat){html+='<div class="filter-chip '+(cat===currentFilter?'active':'')+'" onclick="filterByCategory(\''+cat+'\')">'+cat+'</div>'});document.getElementById('categoryFilters').innerHTML=html}function filterByCategory(category){currentFilter=category;renderCategoryFilters();renderProductList()}document.getElementById('productSearch').addEventListener('input',function(){searchQuery=this.value.toLowerCase();renderProductList()});function renderProductList(){var products=Storage.get('spiStore_products')||[];if(currentFilter!=='All'){products=products.filter(function(p){return p.category===currentFilter})}if(searchQuery){products=products.filter(function(p){return p.name.toLowerCase().includes(searchQuery)})}products.sort(function(a,b){return a.name.localeCompare(b.name)});var container=document.getElementById('productList');if(products.length===0){container.innerHTML='<div class="empty-state"><div class="empty-state-icon">üì¶</div><div class="empty-state-text">Walang produkto</div><div class="empty-state-subtext">Magdagdag ng produkto para magsimula</div></div>';return}var html='';products.forEach(function(p){var margin=((p.sellingPrice-p.costPrice)/p.sellingPrice*100).toFixed(1);var stockStatus='ok';if(p.stock<=p.reorderThreshold*0.5)stockStatus='critical';else if(p.stock<=p.reorderThreshold)stockStatus='low';var statusLabel=stockStatus==='ok'?'OK':stockStatus==='low'?'LOW':'CRITICAL';html+='<div class="product-item"><div class="product-info"><div class="product-name">'+p.name+'</div><div class="product-meta"><span>üí∞ Cost: ‚Ç±'+p.costPrice.toFixed(2)+'</span><span>üíµ Sell: ‚Ç±'+p.sellingPrice.toFixed(2)+'</span><span>üìä Margin: '+margin+'%</span><span>üì¶ '+p.category+'</span></div><div class="product-stock"><span>Stock: <strong>'+p.stock+'</strong> '+p.unit+'</span><span class="stock-badge '+stockStatus+'">'+statusLabel+'</span></div></div><div class="product-controls"><div class="stock-control"><button class="stock-btn" onclick="adjustStock(\''+p.id+'\',-1)">‚àí</button><div class="stock-value">'+p.stock+'</div><button class="stock-btn" onclick="adjustStock(\''+p.id+'\',1)">+</button></div><button class="icon-btn" onclick="editProduct(\''+p.id+'\')" title="Edit">‚úèÔ∏è</button><button class="icon-btn" onclick="confirmDeleteProduct(\''+p.id+'\')" title="Delete">üóëÔ∏è</button></div></div>'});container.innerHTML=html}function adjustStock(productId,delta){var products=Storage.get('spiStore_products')||[];var product=products.find(function(p){return p.id===productId});if(!product)return;product.stock=Math.max(0,product.stock+delta);product.lastUpdated=new Date().toISOString();Storage.set('spiStore_products',products);renderProductList();renderReorderAlerts()}document.getElementById('addProductBtn').addEventListener('click',function(){document.getElementById('newProductName').value='';document.getElementById('newProductCategory').value='';document.getElementById('newProductCost').value='';document.getElementById('newProductPrice').value='';document.getElementById('newProductStock').value='';var settings=Storage.get('spiStore_settings')||{};document.getElementById('newProductReorder').value=settings.defaultReorderThreshold||10;document.getElementById('newProductUnit').value='piraso';openModal('addProductModal')});document.getElementById('saveProductBtn').addEventListener('click',function(){var name=document.getElementById('newProductName').value.trim();var category=document.getElementById('newProductCategory').value;var cost=parseFloat(document.getElementById('newProductCost').value);var price=parseFloat(document.getElementById('newProductPrice').value);var stock=parseInt(document.getElementById('newProductStock').value);var reorder=parseInt(document.getElementById('newProductReorder').value);var unit=document.getElementById('newProductUnit').value;if(!name||!category||isNaN(cost)||isNaN(price)||isNaN(stock)||isNaN(reorder)){showToast('Punan lahat ng required fields!','error');return}if(price<=cost){if(!confirm('Selling price is less than or equal to cost price. Continue?'))return}var products=Storage.get('spiStore_products')||[];products.push({id:generateId(),name:name,category:category,costPrice:cost,sellingPrice:price,stock:stock,reorderThreshold:reorder,unit:unit,dateAdded:new Date().toISOString(),lastUpdated:new Date().toISOString()});Storage.set('spiStore_products',products);closeModal('addProductModal');showToast('Produkto naidagdag! ‚úÖ','success');renderInventoryTab();populateProductSelect()});function editProduct(productId){var products=Storage.get('spiStore_products')||[];var product=products.find(function(p){return p.id===productId});if(!product)return;document.getElementById('editProductId').value=product.id;document.getElementById('editProductName').value=product.name;document.getElementById('editProductCategory').value=product.category;document.getElementById('editProductCost').value=product.costPrice;document.getElementById('editProductPrice').value=product.sellingPrice;document.getElementById('editProductStock').value=product.stock;document.getElementById('editProductReorder').value=product.reorderThreshold;document.getElementById('editProductUnit').value=product.unit;openModal('editProductModal')}document.getElementById('updateProductBtn').addEventListener('click',function(){var id=document.getElementById('editProductId').value;var name=document.getElementById('editProductName').value.trim();var category=document.getElementById('editProductCategory').value;var cost=parseFloat(document.getElementById('editProductCost').value);var price=parseFloat(document.getElementById('editProductPrice').value);var stock=parseInt(document.getElementById('editProductStock').value);var reorder=parseInt(document.getElementById('editProductReorder').value);var unit=document.getElementById('editProductUnit').value;if(!name||!category||isNaN(cost)||isNaN(price)||isNaN(stock)||isNaN(reorder)){showToast('Punan lahat ng required fields!','error');return}var products=Storage.get('spiStore_products')||[];var product=products.find(function(p){return p.id===id});if(!product)return;product.name=name;product.category=category;product.costPrice=cost;product.sellingPrice=price;product.stock=stock;product.reorderThreshold=reorder;product.unit=unit;product.lastUpdated=new Date().toISOString();Storage.set('spiStore_products',products);closeModal('editProductModal');showToast('Produkto na-update! ‚úÖ','success');renderInventoryTab();populateProductSelect()});function confirmDeleteProduct(productId){var products=Storage.get('spiStore_products')||[];var product=products.find(function(p){return p.id===productId});if(!product)return;document.getElementById('confirmMessage').textContent='I-delete ba ang "'+product.name+'"? Hindi na ito maibabalik.';document.getElementById('confirmActionBtn').onclick=function(){deleteProduct(productId)};openModal('confirmModal')}function deleteProduct(productId){var products=Storage.get('spiStore_products')||[];products=products.filter(function(p){return p.id!==productId});Storage.set('spiStore_products',products);closeModal('confirmModal');showToast('Produkto na-delete','success');renderInventoryTab();populateProductSelect()}var reportRange='today';var reportStartDate=null;var reportEndDate=null;function renderReportsTab(){setupReportDateRange();generateReport()}function setupReportDateRange(){var rangeButtons=document.querySelectorAll('.date-range-selector .filter-chip');rangeButtons.forEach(function(btn){btn.addEventListener('click',function(){rangeButtons.forEach(function(b){b.classList.remove('active')});this.classList.add('active');reportRange=this.dataset.range;if(reportRange==='custom'){document.getElementById('customRangeInputs').style.display='block'}else{document.getElementById('customRangeInputs').style.display='none';generateReport()}})});document.getElementById('reportStartDate').addEventListener('change',function(){reportStartDate=new Date(this.value);if(reportEndDate)generateReport()});document.getElementById('reportEndDate').addEventListener('change',function(){reportEndDate=new Date(this.value);if(reportStartDate)generateReport()})}function getReportDateRange(){var now=new Date();var start,end;switch(reportRange){case'today':start=DateUtil.getStartOfDay(now);end=DateUtil.getEndOfDay(now);break;case'week':start=DateUtil.getDaysAgo(7);end=now;break;case'month':start=new Date(now.getFullYear(),now.getMonth(),1);end=now;break;case'custom':if(!reportStartDate||!reportEndDate)return null;start=DateUtil.getStartOfDay(reportStartDate);end=DateUtil.getEndOfDay(reportEndDate);break;default:start=DateUtil.getStartOfDay(now);end=DateUtil.getEndOfDay(now)}return{start:start,end:end}}function generateReport(){var range=getReportDateRange();if(!range)return;var products=Storage.get('spiStore_products')||[];var transactions=Storage.get('spiStore_transactions')||[];var periodTransactions=transactions.filter(function(t){var tDate=new Date(t.timestamp);return tDate>=range.start&&tDate<=range.end});var totalRevenue=0;var totalCost=0;var productPerformance={};var categoryRevenue={};periodTransactions.forEach(function(t){totalRevenue+=t.totalAmount;t.items.forEach(function(item){var product=products.find(function(p){return p.id===item.productId});if(!product)return;var itemCost=product.costPrice*item.quantity;var itemProfit=item.lineTotal-itemCost;totalCost+=itemCost;if(!productPerformance[item.productId]){productPerformance[item.productId]={name:item.productName,category:product.category,unitsSold:0,revenue:0,cost:0,profit:0}}productPerformance[item.productId].unitsSold+=item.quantity;productPerformance[item.productId].revenue+=item.lineTotal;productPerformance[item.productId].cost+=itemCost;productPerformance[item.productId].profit+=itemProfit;if(!categoryRevenue[product.category]){categoryRevenue[product.category]=0}categoryRevenue[product.category]+=item.lineTotal})});var totalProfit=totalRevenue-totalCost;var marginPercent=totalRevenue>0?(totalProfit/totalRevenue*100).toFixed(1):0;var avgTransaction=periodTransactions.length>0?(totalRevenue/periodTransactions.length).toFixed(2):0;var summaryHtml='<div class="summary-card"><div class="summary-card-label">Kabuuang Benta</div><div class="summary-card-value">‚Ç±'+totalRevenue.toFixed(2)+'</div></div><div class="summary-card"><div class="summary-card-label">Kabuuang Puhunan</div><div class="summary-card-value">‚Ç±'+totalCost.toFixed(2)+'</div></div><div class="summary-card"><div class="summary-card-label">Kabuuang Kita</div><div class="summary-card-value" style="color:var(--primary)">‚Ç±'+totalProfit.toFixed(2)+'</div></div><div class="summary-card"><div class="summary-card-label">Gross Margin</div><div class="summary-card-value">'+marginPercent+'%</div></div><div class="summary-card"><div class="summary-card-label">Bilang ng Transaksyon</div><div class="summary-card-value">'+periodTransactions.length+'</div></div><div class="summary-card"><div class="summary-card-label">Average na Benta</div><div class="summary-card-value">‚Ç±'+avgTransaction+'</div></div>';document.getElementById('reportSummary').innerHTML=summaryHtml;renderCategoryBreakdown(categoryRevenue);renderReportDailyTrend(range,transactions);renderProductPerformanceTable(productPerformance)}function renderCategoryBreakdown(categoryRevenue){var categories=Object.keys(categoryRevenue);if(categories.length===0){document.getElementById('categoryBreakdownChart').innerHTML='<div class="empty-state"><div class="empty-state-text">Walang data</div></div>';return}var total=Object.values(categoryRevenue).reduce(function(sum,val){return sum+val},0);var sorted=categories.map(function(cat){return{category:cat,revenue:categoryRevenue[cat],percentage:(categoryRevenue[cat]/total*100).toFixed(1)}}).sort(function(a,b){return b.revenue-a.revenue});var html='<div style="display:flex;flex-direction:column;gap:.75rem">';var maxRevenue=Math.max.apply(Math,sorted.map(function(c){return c.revenue}));sorted.forEach(function(item){var barWidth=(item.revenue/maxRevenue)*100;html+='<div><div style="display:flex;justify-content:space-between;margin-bottom:.25rem"><span style="font-size:.875rem">'+item.category+'</span><span style="font-weight:700;color:var(--primary)">‚Ç±'+item.revenue.toFixed(2)+' ('+item.percentage+'%)</span></div><div style="background:var(--bg);height:8px;border-radius:4px;overflow:hidden"><div style="width:'+barWidth+'%;height:100%;background:var(--primary);border-radius:4px"></div></div></div>'});html+='</div>';document.getElementById('categoryBreakdownChart').innerHTML=html}function renderReportDailyTrend(range,transactions){var days=Math.ceil((range.end-range.start)/(1000*60*60*24))+1;var dailyData=[];for(var i=0;i<Math.min(days,30);i++){var date=new Date(range.start);date.setDate(date.getDate()+i);dailyData.push({date:date,label:date.toLocaleDateString('en-US',{month:'short',day:'numeric'}),revenue:0})}transactions.forEach(function(t){var tDate=new Date(t.timestamp);if(tDate>=range.start&&tDate<=range.end){var dayData=dailyData.find(function(d){return DateUtil.getStartOfDay(d.date).getTime()===DateUtil.getStartOfDay(tDate).getTime()});if(dayData){dayData.revenue+=t.totalAmount}}});if(dailyData.length===0){document.getElementById('reportDailyTrend').innerHTML='<div class="empty-state"><div class="empty-state-text">Walang data</div></div>';return}var maxRevenue=Math.max.apply(Math,dailyData.map(function(d){return d.revenue}).concat([1]));var html='<svg width="100%" height="200" style="margin-top:1rem">';var barWidth=100/dailyData.length;var padding=dailyData.length>15?5:10;dailyData.forEach(function(day,index){var barHeight=(day.revenue/maxRevenue)*150;var x=index*barWidth;var y=150-barHeight;html+='<rect x="'+(x+padding/2)+'%" y="'+y+'" width="'+(barWidth-padding)+'%" height="'+barHeight+'" fill="var(--primary)" rx="4"/>';if(dailyData.length<=15||index%Math.ceil(dailyData.length/15)===0){html+='<text x="'+(x+barWidth/2)+'%" y="170" text-anchor="middle" fill="var(--text2)" font-size="10">'+day.label+'</text>'}if(day.revenue>0){html+='<text x="'+(x+barWidth/2)+'%" y="'+(y-5)+'" text-anchor="middle" fill="var(--primary)" font-size="10" font-weight="600">‚Ç±'+day.revenue.toFixed(0)+'</text>'}});html+='</svg>';document.getElementById('reportDailyTrend').innerHTML=html}function renderProductPerformanceTable(productPerformance){var products=Object.values(productPerformance).map(function(p){return{name:p.name,category:p.category,unitsSold:p.unitsSold,revenue:p.revenue,cost:p.cost,profit:p.profit,margin:p.revenue>0?((p.profit/p.revenue)*100).toFixed(1):0}});if(products.length===0){document.getElementById('productPerformanceBody').innerHTML='<tr><td colspan="6" style="text-align:center;color:var(--text2)">Walang data</td></tr>';return}products.sort(function(a,b){return b.profit-a.profit});var html='';products.forEach(function(p){html+='<tr><td>'+p.name+'</td><td>'+p.unitsSold+'</td><td>‚Ç±'+p.revenue.toFixed(2)+'</td><td>‚Ç±'+p.cost.toFixed(2)+'</td><td style="color:'+(p.profit>=0?'var(--primary)':'var(--danger)')+'">‚Ç±'+p.profit.toFixed(2)+'</td><td>'+p.margin+'%</td></tr>'});document.getElementById('productPerformanceBody').innerHTML=html}function renderShoppingList(){var products=Storage.get('spiStore_products')||[];var lowStockProducts=products.filter(function(p){return p.stock<=p.reorderThreshold}).sort(function(a,b){var aRatio=a.stock/a.reorderThreshold;var bRatio=b.stock/b.reorderThreshold;return aRatio-bRatio});var container=document.getElementById('shoppingList');if(lowStockProducts.length===0){container.innerHTML='<div class="empty-state"><div class="empty-state-icon">‚úÖ</div><div class="empty-state-text">All stocks are good!</div><div class="empty-state-subtext">Walang kailangan bilhin ngayon</div></div>';document.getElementById('shoppingTotal').textContent='‚Ç±0.00';return}var html='';var totalCost=0;lowStockProducts.forEach(function(p){var suggestedQty=Math.max(0,(p.reorderThreshold*2)-p.stock);var estimatedCost=suggestedQty*p.costPrice;totalCost+=estimatedCost;html+='<div class="list-item"><div class="list-item-content"><div class="list-item-title">'+p.name+'</div><div class="list-item-subtitle">Current: '+p.stock+' | Min: '+p.reorderThreshold+' | Suggested: '+suggestedQty+' '+p.unit+'</div><div style="margin-top:.5rem"><span style="font-weight:600;color:var(--primary)">Est. Cost: ‚Ç±'+estimatedCost.toFixed(2)+'</span><span style="margin-left:1rem;color:var(--text2)">(‚Ç±'+p.costPrice.toFixed(2)+' per '+p.unit+')</span></div></div><div class="list-item-actions"><input type="checkbox" style="width:20px;height:20px;cursor:pointer"></div></div>'});container.innerHTML=html;document.getElementById('shoppingTotal').textContent='‚Ç±'+totalCost.toFixed(2)}document.getElementById('printShoppingList').addEventListener('click',function(){var products=Storage.get('spiStore_products')||[];var lowStockProducts=products.filter(function(p){return p.stock<=p.reorderThreshold}).sort(function(a,b){var aRatio=a.stock/a.reorderThreshold;var bRatio=b.stock/b.reorderThreshold;return aRatio-bRatio});if(lowStockProducts.length===0){showToast('Walang items sa shopping list','error');return}var settings=Storage.get('spiStore_settings')||{};var printContent='<html><head><title>Shopping List - '+(settings.storeName||'Sari-Sari Store')+'</title><style>body{font-family:Arial,sans-serif;padding:20px;background:#fff;color:#000}h1{color:#333}table{width:100%;border-collapse:collapse;margin-top:20px}th,td{padding:10px;text-align:left;border-bottom:1px solid #ddd}th{background:#f0f0f0;font-weight:bold}.total{margin-top:20px;font-size:18px;font-weight:bold}.header{margin-bottom:20px}.date{color:#666}</style></head><body><div class="header"><h1>üõí Shopping / Reorder List</h1><div>'+(settings.storeName||'Sari-Sari Store')+'</div><div class="date">'+DateUtil.formatFilipino(new Date())+'</div></div><table><thead><tr><th>‚òê</th><th>Product</th><th>Current Stock</th><th>Min Stock</th><th>Suggested Qty</th><th>Cost per Unit</th><th>Est. Total</th></tr></thead><tbody>';var totalCost=0;lowStockProducts.forEach(function(p){var suggestedQty=Math.max(0,(p.reorderThreshold*2)-p.stock);var estimatedCost=suggestedQty*p.costPrice;totalCost+=estimatedCost;printContent+='<tr><td>‚òê</td><td>'+p.name+'</td><td>'+p.stock+' '+p.unit+'</td><td>'+p.reorderThreshold+' '+p.unit+'</td><td><strong>'+suggestedQty+' '+p.unit+'</strong></td><td>‚Ç±'+p.costPrice.toFixed(2)+'</td><td>‚Ç±'+estimatedCost.toFixed(2)+'</td></tr>'});printContent+='</tbody></table><div class="total">Total Estimated Cost: ‚Ç±'+totalCost.toFixed(2)+'</div></body></html>';var printWindow=window.open('','','width=800,height=600');printWindow.document.write(printContent);printWindow.document.close();printWindow.focus();printWindow.print();printWindow.close()});function loadSettings(){var settings=Storage.get('spiStore_settings')||{};document.getElementById('settingStoreName').value=settings.storeName||'';document.getElementById('settingOwnerName').value=settings.ownerName||'';document.getElementById('settingReorderThreshold').value=settings.defaultReorderThreshold||10}document.getElementById('saveSettingsBtn').addEventListener('click',function(){var settings={storeName:document.getElementById('settingStoreName').value.trim(),ownerName:document.getElementById('settingOwnerName').value.trim(),currency:'‚Ç±',defaultReorderThreshold:parseInt(document.getElementById('settingReorderThreshold').value)||10,appVersion:'1.0'};Storage.set('spiStore_settings',settings);showToast('Settings saved! ‚úÖ','success');updateHeaderDate()});document.getElementById('exportDataBtn').addEventListener('click',function(){var data={products:Storage.get('spiStore_products')||[],transactions:Storage.get('spiStore_transactions')||[],settings:Storage.get('spiStore_settings')||{},exportDate:new Date().toISOString(),version:'1.0'};var dataStr=JSON.stringify(data,null,2);var dataBlob=new Blob([dataStr],{type:'application/json'});var url=URL.createObjectURL(dataBlob);var link=document.createElement('a');link.href=url;link.download='sari-sari-store-backup-'+Date.now()+'.json';link.click();URL.revokeObjectURL(url);showToast('Data exported! üì§','success')});document.getElementById('importDataBtn').addEventListener('click',function(){document.getElementById('importFileInput').click()});document.getElementById('importFileInput').addEventListener('change',function(e){var file=e.target.files[0];if(!file)return;var reader=new FileReader();reader.onload=function(event){try{var data=JSON.parse(event.target.result);if(!data.products||!data.transactions||!data.settings){showToast('Invalid backup file!','error');return}if(confirm('‚ö†Ô∏è Warning: This will overwrite all current data. Continue?')){Storage.set('spiStore_products',data.products);Storage.set('spiStore_transactions',data.transactions);Storage.set('spiStore_settings',data.settings);showToast('Data imported successfully! üì•','success');setTimeout(function(){location.reload()},1500)}}catch(error){showToast('Error reading file!','error')}};reader.readAsText(file);this.value=''});document.getElementById('clearAllDataBtn').addEventListener('click',function(){document.getElementById('confirmMessage').textContent='Sigurado ka ba? Mabubura lahat ng products, sales, at settings. Hindi na ito maibabalik!';document.getElementById('confirmActionBtn').onclick=function(){if(confirm('LAST WARNING: I-delete talaga lahat ng data?')){Storage.remove('spiStore_products');Storage.remove('spiStore_transactions');Storage.remove('spiStore_settings');closeModal('confirmModal');showToast('All data cleared! Reloading...','success');setTimeout(function(){location.reload()},1500)}};openModal('confirmModal')});document.getElementById('fabNewSale').addEventListener('click',function(){document.querySelectorAll('.tab-button').forEach(function(btn){btn.classList.remove('active')});document.querySelectorAll('.tab-content').forEach(function(content){content.classList.remove('active')});document.querySelector('[data-tab="sales"]').classList.add('active');document.getElementById('sales').classList.add('active');renderSalesTab()});document.addEventListener('DOMContentLoaded',function(){initializeSampleData();initNavigation();updateHeaderDate();renderDashboard();renderSalesTab();renderInventoryTab();loadSettings();setInterval(updateHeaderDate,60000)});
</script></body></html>
